# =============================================================================
# Interactive OpenCV Watershed Segmentation Service Configuration
#
# This config file sets up the SegmentViaPoints algorithm using OpenCV's
# watershed algorithm for interactive point-based segmentation in DIVE.
#
# The watershed algorithm uses user-provided foreground and background click
# points to seed the segmentation. Foreground points mark the object to segment,
# while background points mark areas that should not be included.
#
# Usage:
#   python -m viame.core.interactive_segmentation --config interactive_segmenter_watershed.conf
# =============================================================================

# -----------------------------------------------------------------------------
# Image IO Algorithm Configuration
# -----------------------------------------------------------------------------
# Use KWIVER native image loading to avoid memory layout issues with PIL/numpy
image_io:type = vxl

# -----------------------------------------------------------------------------
# Segment Via Points Algorithm Configuration
# -----------------------------------------------------------------------------
# Use OpenCV watershed for point-based segmentation
segment_via_points:type = ocv_watershed

# Seed region parameters
# Radius of foreground seed regions around click points (pixels)
segment_via_points:ocv_watershed:foreground_radius = 5

# Radius of background seed regions around click points (pixels)
segment_via_points:ocv_watershed:background_radius = 3

# Morphological operations for post-processing
# Kernel size for morphological operations (erosion/dilation)
segment_via_points:ocv_watershed:morph_kernel_size = 3

# Number of iterations for morphological operations
segment_via_points:ocv_watershed:morph_iterations = 2

# Pre-processing parameters
# Gaussian blur kernel size (0 to disable)
segment_via_points:ocv_watershed:blur_kernel_size = 5

# Use gradient magnitude to guide watershed boundaries
segment_via_points:ocv_watershed:use_gradient = true

# Post-processing parameters
# Minimum area in pixels for output segments
segment_via_points:ocv_watershed:min_area = 100

# Fill holes in the output mask
segment_via_points:ocv_watershed:fill_holes = true

# Factor to expand bounding box for uncertain watershed region
segment_via_points:ocv_watershed:expansion_factor = 2.0

# -----------------------------------------------------------------------------
# Service Configuration
# -----------------------------------------------------------------------------
service:hole_policy = remove
service:multipolygon_policy = largest
service:max_polygon_points = 25
service:adaptive_simplify = false

# -- end of file --
