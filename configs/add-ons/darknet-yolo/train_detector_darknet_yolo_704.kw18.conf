# =============================================================================
# Title: Train Detector - DARKNET YOLO 704.kw18
#
# Description: Configuration for training YOLO. Uses the Darknet deep learning
# framework. Configured for KW18 format input annotations.
# =============================================================================

include common_train_detector.conf

#  Override groundtruth settings for KW18 format
groundtruth_extensions = .kw18
groundtruth_reader:type = kw18

#  Pipeline template file.
relativepath pipeline_template = templates/embedded_yolo.pipe


#  Algorithm to use for 'detector_trainer'.
#  Must be one of the following options: darket, scallop_tk
detector_trainer:type = darknet

#  GPU index. Only used when darknet is compiled with GPU support.
detector_trainer:darknet:gpu_index = 0

#  Type of network
detector_trainer:darknet:model_type = yolov4

#  Name of network config file.
relativepath detector_trainer:darknet:net_config = models/yolo_train.cfg

#  Seed weights file.
relativepath detector_trainer:darknet:seed_weights = models/yolo_seed.wt

# Image reader parameters
detector_trainer:darknet:image_reader:type = vxl
detector_trainer:darknet:image_reader:vxl:force_byte = true

#  Directory for all files used in training and output models.
detector_trainer:darknet:train_directory = deep_training

#  Output directory.
detector_trainer:darknet:output_directory = category_models

#  Only chips with valid groundtruth objects on them will be included in
#  training.
detector_trainer:darknet:chips_w_gt_only = false

#  Maximum negative frame ratio
detector_trainer:darknet:max_neg_ratio = 1

#  Pre-processing resize option, can be: disabled, maintain_ar, scale, chip, or
#  chip_and_original.
detector_trainer:darknet:resize_option = chip_and_original

#  Image scaling factor used when resize_option is scale or chip.
detector_trainer:darknet:scale = 1.0

#  Width resolution for darknet base layer.
detector_trainer:darknet:resize_width = 704

#  Height resolution for darknet base layer.
detector_trainer:darknet:resize_height = 704

#  When in chip mode, the chip step size between chips.
detector_trainer:darknet:chip_step = 584

#  Batch size to use during training
detector_trainer:darknet:batch_size = 64

#  Batch subdivisions to use during training
detector_trainer:darknet:batch_subdivisions = 16

#  Percentage of which a target must appear on a chip for it to be included as a
#  training sample for said chip.
detector_trainer:darknet:overlap_required = 0.05

#  Random intensity shift chip augmentation [0.0,1.0] - 0.0 is turned off.
detector_trainer:darknet:random_int_shift = 0.60

#  Skip file formatting, assume that the train_directory is pre-populated with
#  all files required for model training.
detector_trainer:darknet:skip_format = false
