# =============================================================================
# Title: Interactive Stereo Service Configuration - Epipolar Template Matching
#
# Description: KWIVER flat config for the interactive stereo annotation service.
# Used by python -m viame.core.interactive_stereo for interactive point transfer
# in DIVE stereo annotation mode.
#
# This configuration uses epipolar template matching (the same approach as
# measurement_from_annotations_template.pipe). For each point to transfer,
# the epipolar curve is computed from camera calibration and a template patch
# is matched along it using Normalized Cross-Correlation (NCC). This method
# does not require GPU.
#
# When the fdn-stereo add-on is enabled, this is overridden by dense disparity
# computation using Foundation-Stereo.
# =============================================================================

matching_method = epipolar_template_matching

# ---------------------------------------------------------------------------
# Template matching parameters
# ---------------------------------------------------------------------------
# Template window size (must be odd). Larger = more robust but slower.
template_size = 13

# Minimum NCC score to accept a match (0-1 range).
template_matching_threshold = 0.5

# ---------------------------------------------------------------------------
# Epipolar search range (disparity-based, in pixels)
# ---------------------------------------------------------------------------
# Disparity is how far a point shifts between left and right images.
# These define the search range along the epipolar curve.
#
# Alternatively, set epipolar_min_depth / epipolar_max_depth in calibration
# units (e.g. mm). Depth parameters are only used when both disparity
# parameters are 0.
epipolar_min_disparity = 2
epipolar_max_disparity = 300
# epipolar_min_depth = 2000
# epipolar_max_depth = 200000

# Number of sample points along the epipolar curve.
epipolar_num_samples = 5000

# ---------------------------------------------------------------------------
# Service settings
# ---------------------------------------------------------------------------
service:scale = 1.0
