# =============================================================================
# Title: Train Detector - NETHARN CFRNN Wtf
#
# Description: Configuration for training object detector. Uses the NetHarn
# deep learning framework. Input resolution: 1280px.
# =============================================================================

include common_train_detector.conf

#  Pipeline template file.
relativepath pipeline_template = templates/embedded_netharn_wtf.pipe

#  Augmentation pipeline.
relativepath augmentation_pipeline = train_aug_enhance_and_add_motion.pipe

#  Augmentatation cache.
augmentation_cache = augmented_images

#  Always re-run augmentations on new runs.
regenerate_cache = true


#  Algorithm to use for 'detector_trainer'.
detector_trainer:type = netharn

block detector_trainer:netharn

  # Number of GPUs to use, -1 indicates all
  gpu_count = -1

  # Architecture
  arch = MM_HRNetV2_w18_MaskRCNN

  # Network perspective field size
  chip_width = 1280

  # Backbone file
  relativepath backbone = models/pytorch_resnext101.pth

  # Max timeout in seconds (example = 604800, or one week)
  timeout = default

  # Image train batch size
  batch_size = auto

  # Training learning rate
  learning_rate = auto

  # Augmentation method
  augmentation = complex

  # Specify extension for motion image files
  aux_image_labels = motion
  aux_image_extensions = _aux

endblock
