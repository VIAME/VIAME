# =============================================================================
# Title: Train Tracker - SAM3 Segmentation
#
# Description: Configuration for training/fine-tuning SAM3 (Segment Anything
# Model 3) for segmentation tasks using track-level annotations. Supports
# temporal consistency through track IDs and memory-based training.
# =============================================================================

# SAM3 Tracker Training Configuration
#
# This configuration file is used with viame_train_detector when training
# a SAM3 tracker using the --tracker/-tt option.
#
# SAM3 tracker training involves fine-tuning the segmentation model using
# track-level annotations to maintain temporal consistency and leverage
# the memory module for improved tracking.
#
# Example usage:
#   viame_train_detector -i /path/to/training/data -tt sam3
#
# Or with a custom config:
#   viame_train_detector -i /path/to/training/data -c train_tracker_sam3.conf

# Track reader configuration
track_reader:type = viame_csv

# Tracker trainer configuration
tracker_trainer:type = sam3

# Model identifier for output files
tracker_trainer:sam3:identifier = viame-sam3-tracking

# SAM model to fine-tune
# Options: facebook/sam2.1-hiera-large, facebook/sam2.1-hiera-base,
#          facebook/sam2.1-hiera-small, facebook/sam2.1-hiera-tiny
tracker_trainer:sam3:sam_model_id = facebook/sam2.1-hiera-large

# Directory for intermediate training files
tracker_trainer:sam3:train_directory = deep_training

# Directory for final trained model output
tracker_trainer:sam3:output_directory = category_models

# Number of GPUs to use (-1 for auto-detect)
tracker_trainer:sam3:gpu_count = -1

# Network perspective field size
tracker_trainer:sam3:chip_width = 1024
tracker_trainer:sam3:chip_height = 1024

# Maximum training epochs
tracker_trainer:sam3:max_epochs = 50

# Batch size for training
tracker_trainer:sam3:batch_size = 4

# Learning rate
tracker_trainer:sam3:learning_rate = 1e-5

# Confidence threshold for groundtruth filtering
tracker_trainer:sam3:threshold = 0.00

# Training timeout in seconds (default: 1 week)
tracker_trainer:sam3:timeout = 604800

# Freeze image encoder (recommended for fine-tuning)
tracker_trainer:sam3:freeze_image_encoder = true

# Freeze prompt encoder (recommended for fine-tuning)
tracker_trainer:sam3:freeze_prompt_encoder = true

# Freeze memory encoder (set to false for tracking training)
tracker_trainer:sam3:freeze_memory_encoder = false

# Enable automatic mixed precision
tracker_trainer:sam3:amp_enabled = true

# Enable memory-based training for temporal consistency
tracker_trainer:sam3:use_memory_training = true

# Augmentation method (standard, complex, or none)
tracker_trainer:sam3:augmentation = standard

# Pipeline template for generating deployment pipeline
#tracker_trainer:sam3:pipeline_template = templates/embedded_sam3_tracker.pipe
